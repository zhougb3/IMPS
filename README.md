IMPS项目介绍

技术要点

服务端：

1. 使用epoll加多线程搭建服务器，epoll负责监控所有套接字的可读事件，对于每个事件则使用一个线程进行处理，为了避免频繁创建线程，使用了线程池技术。通过使用互斥量来使得线程同步。
2. 采用先发送消息长度再发送消息的机制解决粘包问题，同时使用特殊的字符来区分不同的字符串含义。在指定消息长度时，使用的是类型uint32_t，保证了平台无关性。

客户端：

	使用两个线程分离socket的读事件和写事件，使得socket的读写可以并发执行

读写处理：

	因为在读取socket缓冲时，必须得读到消息长度指定的字节数才可以进行处理。所以，每次读取都先使用MSG_PEEK参数进行读取，保证能读到指定字节数时才真正从缓冲区中清除。

功能

1. 功能十分简陋，没有错误检测，所以输入有误随时崩溃~~
2. 使用上是连接上服务器，然后发送您的用户名给服务器。服务器会返回当前在线用户的socket套接字描述符和用户名。你再输入一个套接字描述符，那么你就可以发消息给这个用户了。有新用户上线还是用户离开都会提示你。
3. 你可以收到来自不同在线用户给你发的消息。
4. 程序只能Ctrl+C退出，你选定了聊天的用户后就不可以更改了哈哈哈哈
5. 服务端要做的事就是存储你的名字，和你要聊天的用户，以及随时将你的信息转发给指定用户。还有实时推送新用户上线还是已有用户离开。
6. 代码结构没有优化过，有点丑~~~

问题考虑

1. 当epoll检测到指定事件发生时，会调用一个线程进行socket读写，这个时候为了防止这个socket频繁触发epoll事件，则将这个socket从epoll中删除，当线程处理完后再重新添加到epoll中去监听。
2. https://www.cnblogs.com/dubo-/p/5586036.html








